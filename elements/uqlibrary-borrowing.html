<link rel="import" href="elements.html">
<link rel="import" href="uqlibrary-loans.html">
<link rel="import" href="uqlibrary-holds.html">
<link rel="import" href="uqlibrary-fines.html">

<!--
Element providing an overview for loans, holds and fines.
##### Example

<uqlibrary-borrowing></uqlibrary-borrowing>
<script>
  window.addEventListener('polymer-ready', function() {
    var borrowing = document.querySelector('uqlibrary-borrowing');
    borrowing.data = {
      "checkedOut": [
        {
          "title": "Pharmaceutics : the science of dosage form design",
          "dueDate": "2014-12-06T04:00:00+10:00",
          "url": "http:\/\/library.uq.edu.au\/record=i3349004"
        }
      ],
      "holds": [
        {
          "title": "Regression analysis of count data",
          "datePlaced": "2014-11-22T14:00:00+10:00",
          "url": "http:\/\/library.uq.edu.au\/record=i2673780",
          "status": 'onHold'
        },
        {
          "title": "Regression analysis of count data. Part 2",
          "datePlaced": "2014-02-12T14:00:00+10:00",
          "url": "http:\/\/library.uq.edu.au\/record=i2673780",
          "pickupLocation": 'BSL - Level 3',
          "status": 'itemReady'
        }
      ],
      "fines": [
        {
          "title": "1. Human physiology : from cells to systems \/ Lauralee Sherwood.",
          "fineAmount": 840,
          "dueDate": "2014-04-08T04:00:00+10:00",
          "dateReturned": "2014-04-14T14:02:05+10:00",
          "dateAssessed": "2014-04-15T14:02:05+10:00",
          "description": "Book loan overdue",
          "fineType": "overdue",
          "url": "http:\/\/library.uq.edu.au\/record=i3698283"
        },
        {
          "title": "2. Human physiology : from cells to systems \/ Lauralee Sherwood.",
          "fineAmount": 160,
          "dueDate": "2013-04-22T04:00:00+10:00",
          "dateReturned": "2013-04-24T14:44:15+10:00",
          "dateAssessed": "2013-04-25T14:02:05+10:00",
          "description": "Book loan overdue and slight damage",
          "fineType": "overdue",
          "url": "http:\/\/library.uq.edu.au\/record=i3704585"
        }
      ]
    }
  });
</script>

@element uqlibrary-borrowing
@blurb Element providing an overview for loans, holds and fines.
@status alpha
@homepage http://uqlibrary.github.io/uqlibrary-borrowing
-->

<!-- Location of the script -->
<dom-module id="uqlibrary-borrowing">
  <link rel="import" type="css" href="uqlibrary-borrowing.css">
  <template>

    <uqlibrary-api-account id="account"></uqlibrary-api-account>
    <uqlibrary-api-account-loans id="loansApi"></uqlibrary-api-account-loans>

    <uqlibrary-ga id="ga" appName="Borrowing"></uqlibrary-ga>

    <paper-drawer-panel id="drawerPanel" class="flex drawer">

      <div drawer="" class="left-drawer" style="overflow: scroll;">
        <uqlibrary-menu id="uqlibraryMenu" account="{{user}}"></uqlibrary-menu>
      </div>

      <div class="main">
        <paper-toolbar>
          <iron-a11y-keys id="a11yToolBarLeftButton" target="{{_polywrapper('toolBarLeftButton')}}"
                          keys="{{keyboardNavigationKeys}}" on-keys-pressed=" a11yKeyPressed "></iron-a11y-keys>
          <paper-icon-button id="toolBarLeftButton" icon="menu" core-drawer-toggle=""></paper-icon-button>
          <h1 flex="" id="toolbar-page-title">Borrowing</h1>
        </paper-toolbar>
        <div id="content" class="flex">

          <paper-tabs id="tabs" selected="0" selectedIndex="0">

            <iron-a11y-keys id="a11yLoansTab" target="{{_polywrapper('loansTab')}}" keys="{{keyboardNavigationKeys}}"
                            on-keys-pressed="{{tabLoanSelected}}"></iron-a11y-keys>
            <iron-a11y-keys id="a11yHoldsTab" target="{{_polywrapper('holdsTab')}}" keys="{{keyboardNavigationKeys}}"
                            on-keys-pressed="{{tabHoldsSelected}}"></iron-a11y-keys>
            <iron-a11y-keys id="a11yFinesTab" target="{{_polywrapper('finesTab')}}" keys="{{keyboardNavigationKeys}}"
                            on-keys-pressed="{{tabFinesSelected}}"></iron-a11y-keys>

            <paper-tab name="loans" id="loansTab" aria-label="loans">
              <div class="menu layout horizontal center">
                <a href="javascript:;" class="layout vertical center">
                  <span class="tabTitleNumber">{{ data.checkedOut.length }}</span>
                  <span class="tabTitle">Loans</span>
                </a>
              </div>
            </paper-tab>

            <paper-tab name="holds" id="holdsTab" aria-label="holds">
              <div class="menu layout horizontal center">
                <a href="javascript:;" class="layout vertical center">
                  <span class="tabTitleNumber">{{ data.holds.length }}</span>
                  <span class="tabTitle">Holds</span>
                </a>
              </div>
            </paper-tab>

            <paper-tab name="fines" id="finesTab" aria-label="overdue charges">
              <div class="menu layout horizontal center">
                <a href="javascript:;" class="layout vertical center">
                  <span class="tabTitleNumber">{{ sumFines }}</span>
                  <span class="tabTitle">Overdue Charges</span>
                </a>
              </div>
            </paper-tab>
          </paper-tabs>

          <iron-pages selected="0" class="container">
            <div class="flex">
              <uqlibrary-loans id="loans" loans="{{ data.checkedOut }}"></uqlibrary-loans>
            </div>
            <div class="flex">
              <uqlibrary-holds id="holds" holds="{{ data.holds }}"></uqlibrary-holds>
            </div>
            <div class="flex">
              <uqlibrary-fines id="fines" fines="{{ data.fines }}"></uqlibrary-fines>
            </div>
          </iron-pages>
        </div>
      </div>
    </paper-drawer-panel>
  </template>
  <script src="../scripts/uqlibrary-borrowing.js"></script>
</dom-module>